(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9596],{9596:(bt,K,w)=>{"use strict";w.r(K),w.d(K,{GamePage:()=>$});var Y=w(6895),y=w(433),x=w(6114),l=(()=>{return(c=l||(l={}))[c.Up=0]="Up",c[c.Down=1]="Down",c[c.Left=2]="Left",c[c.Right=3]="Right",c[c.Stopped=4]="Stopped",l;var c})(),f=(()=>{return(c=f||(f={}))[c.WALL=0]="WALL",c[c.BISCUIT=1]="BISCUIT",c[c.EMPTY=2]="EMPTY",c[c.BLOCK=3]="BLOCK",c[c.PILL=4]="PILL",c[c.LEFT_DOOR=5]="LEFT_DOOR",c[c.RIGHT_DOOR=6]="RIGHT_DOOR",f;var c})();class ft{constructor(n,i){this.width=19,this.height=11,this.cellSize=30,this.winner=!1,this.step=0,this.level=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,4,1,0,0,1,1,1,0,1,1,1,0,0,1,4,1,0],[0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0],[0,1,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,1,0],[0,1,0,1,0,0,1,1,1,1,1,1,1,0,0,1,0,1,0],[0,1,0,1,1,1,1,0,0,0,0,0,1,1,1,1,0,1,0],[0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,1,1,1,0],[0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,1,1,3,1,1,1,0,0,1,0,0,0],[5,1,1,1,0,0,0,0,3,3,3,0,0,0,0,1,1,1,6],[0,0,0,1,0,0,1,1,1,0,1,1,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,0,0],[0,0,0,1,1,1,1,0,1,0,1,0,1,1,1,1,0,0,0],[0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,1,1,1,0],[0,1,0,1,1,1,1,0,0,0,0,0,1,1,1,1,0,1,0],[0,1,0,1,0,0,1,1,1,1,1,1,1,0,0,1,0,1,0],[0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0],[0,1,0,1,0,0,1,0,1,0,1,0,1,0,0,1,0,1,0],[0,1,4,1,0,0,1,1,1,0,1,1,1,0,0,1,4,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.pillSize=10,this.pillBigger=!1,this.context=n,this.game=i}getElement(n,i){return this.level[i][n]}setElement(n,i,o){this.level[i][n]=o}update(){this.step++;let n=!0;for(let i=0;i<this.level.length;i++)for(let o=0;o<this.level[i].length;o++)(this.level[i][o]===f.BISCUIT||this.level[i][o]===f.PILL)&&(n=!1);this.winner=n}draw(){this.drawMaze()}drawMaze(){for(let n=0;n<this.level.length;n++)for(let i=0;i<this.level[n].length;i++)if(this.level[n][i]===f.BISCUIT)this.drawBlock(n,i),this.drawBiscuit(n,i);else if(this.level[n][i]===f.PILL){if(this.game.sound.playingIntro)continue;this.drawBlock(n,i),this.drawPill(n,i)}else this.level[n][i]===f.BLOCK||this.level[n][i]===f.EMPTY?this.drawBlock(n,i):this.level[n][i]===f.WALL?this.drawWall(n,i):(this.level[n][i]===f.LEFT_DOOR||this.level[n][i]===f.RIGHT_DOOR)&&this.drawPortal(n,i)}drawBiscuit(n,i){this.context.fillStyle="whitesmoke",this.context.beginPath(),this.context.arc(30*i+15,30*n+15,5,0,2*Math.PI),this.context.fill()}drawPill(n,i){this.context.fillStyle="yellow",this.context.beginPath(),this.context.arc(30*i+15,30*n+15,this.pillSize,0,2*Math.PI),this.context.fill(),this.step%3==0&&(this.pillSize>10?this.pillBigger=!1:this.pillSize<6&&(this.pillBigger=!0),this.pillBigger?this.pillSize++:this.pillSize--)}drawBlock(n,i){this.context.fillStyle="black",this.context.fillRect(30*i,30*n,30,30)}drawWall(n,i){switch(this.game.settingsService.levelColor){case"green":this.context.fillStyle="green";break;case"pink":this.context.fillStyle="pink";break;case"blue":default:this.context.fillStyle="blue";break;case"purple":this.context.fillStyle="purple";break;case"yellow":this.context.fillStyle="yellow";break;case"orange":this.context.fillStyle="orange";break;case"red":this.context.fillStyle="red"}this.context.fillRect(30*i,30*n,30,30),this.context.fillStyle="black",this.context.fillRect(30*i+5,30*n+5,20,20),i>0&&this.level[n][i-1]===f.WALL&&(this.context.fillStyle="black",this.context.fillRect(30*i,30*n+5,5,20)),i<this.level[n].length-1&&this.level[n][i+1]===f.WALL&&(this.context.fillStyle="black",this.context.fillRect(30*i+25,30*n+5,5,20)),n>0&&this.level[n-1][i]===f.WALL&&(this.context.fillStyle="black",this.context.fillRect(30*i+5,30*n,20,5)),n<this.level.length-1&&this.level[n+1][i]===f.WALL&&(this.context.fillStyle="black",this.context.fillRect(30*i+5,30*n+25,20,5))}drawPortal(n,i){this.context.fillStyle="#B400FF",this.context.fillRect(30*i,30*n,30,30),this.context.fillStyle="black",this.context.fillRect(30*i+5,30*n+5,20,20)}}var m=(()=>{return(c=m||(m={}))[c.BISCUIT=0]="BISCUIT",c[c.PILL=1]="PILL",c[c.LEFT_DOOR=2]="LEFT_DOOR",c[c.RIGHT_DOOR=3]="RIGHT_DOOR",c[c.DEATH=4]="DEATH",c[c.FRUIT=5]="FRUIT",c[c.INTRO=6]="INTRO",m;var c})(),b=(()=>{return(c=b||(b={}))[c.INTRO=0]="INTRO",c[c.POWERUP=1]="POWERUP",c[c.DEATH=2]="DEATH",c[c.GAME_OVER=3]="GAME_OVER",b;var c})();class G{constructor(n){this.settingsService=n,this.playingIntro=!1,this.playingPowerup=!1,this.playingDeath=!1,this.synth=(new Tone.Synth).toDestination()}playSound(n){if(!this.settingsService.muteSound)switch(n){case m.LEFT_DOOR:case m.RIGHT_DOOR:case m.PILL:this.synth.triggerAttackRelease("C5","8n",Tone.now()+.09);break;case m.BISCUIT:this.synth.triggerAttackRelease("D3","64n",Tone.now()+.09);break;case m.FRUIT:this.playMelody(b.POWERUP);break;case m.DEATH:this.playMelody(b.DEATH);break;case m.INTRO:this.playMelody(b.INTRO)}}playMelody(n){if(this.settingsService.muteSound)return;let i=[];switch(n){case b.INTRO:this.playingIntro=!0,i=[{note:"E5",duration:"4n"},{note:"G5",duration:"4n"},{note:"A5",duration:"8n"},{note:"G5",duration:"8n"},{note:"F5",duration:"4n"},{note:"E5",duration:"4n"},{note:"C5",duration:"8n"},{note:"E5",duration:"8n"},{note:"D5",duration:"4n"},{note:"C5",duration:"4n"},{note:"G4",duration:"4n"},{note:"E5",duration:"4n"},{note:"G5",duration:"4n"},{note:"A5",duration:"8n"},{note:"G5",duration:"8n"},{note:"F5",duration:"4n"},{note:"E5",duration:"4n"},{note:"C5",duration:"8n"},{note:"E5",duration:"8n"},{note:"D5",duration:"4n"},{note:"C5",duration:"4n"},{note:"G4",duration:"4n"}];break;case b.POWERUP:this.playingPowerup=!0,i=[{note:"G5",duration:"8n"},{note:"D5",duration:"8n"},{note:"G4",duration:"8n"},{note:"B4",duration:"8n"},{note:"D5",duration:"4n"},{note:"B4",duration:"4n"}];break;case b.DEATH:this.playingDeath=!0,i=[{note:"C4",duration:"16n"},{note:"C3",duration:"8n"},{note:"C2",duration:"8n"},{note:"C1",duration:"4n"},{note:"C0",duration:"2n"}]}const o=(new Tone.Synth).toDestination();let d=0;i.forEach(N=>{const Tt=Tone.now();o.triggerAttackRelease(N.note,N.duration,Tt+.14*d),d++}),setTimeout(()=>{this.playingIntro=!1,this.playingPowerup=!1,this.playingDeath=!1},1e3*i.length*.14)}}class C{constructor(n,i){this.speed=10,this.dead=!0,this.blinking=!1,this.enemySize=6,this.enemyGrow=!0,this.context=n,this.maze=i.maze,this.snake=i.snake,this.game=i,this.direction=l.Right,this.position=this.getPositionOnScreen(9,10),this.reset()}draw(){this.dead?this.maze.step%200==0&&this.reset():this.blinking?(this.context.beginPath(),this.context.fillStyle="rgb(0, 255, 255)",this.context.arc(this.position.x+15,this.position.y+15,this.enemySize,0,2*Math.PI),this.context.fill(),this.maze.step%2==0&&(this.enemySize>10?this.enemyGrow=!1:this.enemySize<6&&(this.enemyGrow=!0),this.enemyGrow?this.enemySize++:this.enemySize--),this.maze.step%150==0&&(this.blinking=!1)):(this.context.beginPath(),this.context.fillStyle="red",this.context.arc(this.position.x+15,this.position.y+15,12,0,2*Math.PI),this.context.fill())}update(){this.dead||(this.move(),this.detectCollissionWithSnake(),this.detectCollissionWithDoor())}detectCollissionWithSnake(){const n=this.position;for(let i=0;i<this.snake.segments.length;i++){const o=this.snake.segments[i];o.x===n.x&&o.y===n.y&&(this.blinking?this.die():this.snake.die())}}detectCollissionWithDoor(){const n=this.position;let i=this.getPositionInMaze(n.x,n.y);if(this.maze.getElement(i.col,i.row)===f.LEFT_DOOR){let o=this.findGameElementPosition(f.RIGHT_DOOR);this.position.x=this.getPositionOnScreen(o.col-1,o.row).x}if(this.maze.getElement(i.col,i.row)===f.RIGHT_DOOR){let o=this.findGameElementPosition(f.LEFT_DOOR);this.position.x=this.getPositionOnScreen(o.col+1,o.row).x}}findGameElementPosition(n){for(let i=0;i<this.maze.level.length;i++)for(let o=0;o<this.maze.level[i].length;o++)if(this.maze.level[i][o]===n)return{col:o,row:i};return{col:9,row:12}}getPositionInMaze(n,i){let o=9,d=12;return(this.direction===l.Right||this.direction===l.Down)&&(o=Math.ceil(n/this.maze.cellSize),d=Math.ceil(i/this.maze.cellSize)),(this.direction===l.Up||this.direction===l.Left)&&(o=Math.floor(n/this.maze.cellSize),d=Math.floor(i/this.maze.cellSize)),{col:o,row:d}}getPositionOnScreen(n,i){return{x:n*this.maze.cellSize,y:i*this.maze.cellSize}}move(){const n=this.position;let i,o;switch(this.direction){case l.Up:i=this.getPositionInMaze(n.x,n.y-this.speed),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:o.x,y:n.y-this.speed});break;case l.Down:i=this.getPositionInMaze(n.x,n.y+this.speed),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:o.x,y:n.y+this.speed});break;case l.Left:i=this.getPositionInMaze(n.x-this.speed,n.y),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:n.x-this.speed,y:o.y});break;case l.Right:i=this.getPositionInMaze(n.x+this.speed,n.y),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:n.x+this.speed,y:o.y})}this.maze.step%20==0&&this.setRandomDirection(),this.maze.step%30==0&&this.updateDirection()}updateDirection(){let n=this.snake.segments[0];if(!n)return;const i=n.x-this.position.x,o=n.y-this.position.y;Math.sqrt(i*i+o*o),this.direction=this.blinking?i>0&&Math.abs(i)>Math.abs(o)?l.Right:i<0&&Math.abs(i)>Math.abs(o)?l.Left:o>0?l.Down:l.Up:i<0&&Math.abs(i)>Math.abs(o)?l.Right:i>0&&Math.abs(i)>Math.abs(o)?l.Left:o<0?l.Down:l.Up}setRandomDirection(){switch(Math.floor(4*Math.random())){case 0:this.direction=l.Up;break;case 1:this.direction=l.Down;break;case 2:this.direction=l.Left;break;case 3:this.direction=l.Right}}detectWallCollision(n,i){switch(this.direction){case l.Up:case l.Down:case l.Left:case l.Right:if(this.maze.getElement(n,i)===f.WALL)return!0}return!1}die(){this.game.sound.playSound(m.DEATH),this.dead=!0,this.game.score=this.game.score+20}reset(){this.blinking=!1,this.dead=!1,this.position=this.getPositionOnScreen(9,10)}}class gt{constructor(n,i){this.segments=[],this.speed=10,this.dead=!0,this.color=0,this.particles=[],this.context=n,this.maze=i.maze,this.game=i,this.direction=l.Stopped,this.nextDirection=l.Stopped,this.reset()}draw(){if(0!==this.segments.length)for(let n=this.segments.length-1;n>=0;n--){const i=this.segments[n];if(this.context.beginPath(),0===n)switch(this.game.settingsService.snakeColor){case"red":this.context.fillStyle="red";break;case"blue":default:this.context.fillStyle="blue";break;case"green":this.context.fillStyle="darkgreen";break;case"yellow":this.context.fillStyle="yellow";break;case"purple":this.context.fillStyle="purple";break;case"orange":this.context.fillStyle="orange";break;case"pink":this.context.fillStyle="pink"}else if(this.game.enemy.blinking)this.color+=1,this.color>255&&(this.color=0),this.context.fillStyle=`hsl(${this.color}, 100%, 50%)`;else switch(this.game.settingsService.snakeColor){case"red":this.context.fillStyle="rgba(255, 0, 0, 0.8)";break;case"blue":this.context.fillStyle="rgba(0, 0, 255, 0.5)";break;case"green":this.context.fillStyle="rgba(0, 128, 0, 0.5)";break;case"yellow":this.context.fillStyle="rgba(255, 255, 0, 0.5)";break;case"purple":this.context.fillStyle="rgba(128, 0, 128, 0.5)";break;case"orange":this.context.fillStyle="rgba(255, 165, 0, 0.5)";break;case"pink":this.context.fillStyle="rgba(255, 192, 203, 0.5)";break;default:this.context.fillStyle="rgb(203, 195, 227)"}this.context.arc(i.x+15,i.y+15,10,0,2*Math.PI),this.context.fill()}this.drawParticles()}createParticles(){this.particles=[];for(let n=0;n<25;n++)this.particles.push({x:this.segments[0].x,y:this.segments[0].y,size:8*Math.random()+2,speedX:5*Math.random()*2-5,speedY:5*Math.random()*2-5,color:`rgb(${255*Math.random()}, ${255*Math.random()}, ${255*Math.random()})`})}drawParticles(){if(this.game.enemy.blinking)for(let n=0;n<this.particles.length;n++){const i=this.particles[n];this.context.fillStyle=i.color,this.context.fillRect(i.x,i.y,i.size,i.size),i.x+=i.speedX,i.y+=i.speedY}}update(){0!==this.segments.length&&!1===this.game.sound.playingIntro&&!1===this.game.sound.playingDeath&&!1===this.game.sound.playingPowerup&&(this.move(),this.detectCollissionWithBiscuit(),this.detectCollissionWithPill(),this.detectCollissionWithTail(),this.detectCollissionWithDoor())}detectCollissionWithTail(){if(!this.game.enemy.blinking){const n=this.segments[0];this.segments.length>2&&this.segments.filter(i=>i.x===n.x&&i.y===n.y).length>1&&this.die()}}detectCollissionWithDoor(){const n=this.segments[0];let i=this.getPositionInMaze(this.direction,n.x,n.y);if(this.maze.getElement(i.col,i.row)===f.LEFT_DOOR){this.game.sound.playSound(m.LEFT_DOOR);let o=this.findGameElementPositionInMaze(f.RIGHT_DOOR);this.segments[0].x=this.getPositionOnScreen(o.col-1,o.row).x}if(this.maze.getElement(i.col,i.row)===f.RIGHT_DOOR){this.game.sound.playSound(m.RIGHT_DOOR);let o=this.findGameElementPositionInMaze(f.LEFT_DOOR);this.segments[0].x=this.getPositionOnScreen(o.col+1,o.row).x}}findGameElementPositionInMaze(n){for(let i=0;i<this.maze.level.length;i++)for(let o=0;o<this.maze.level[i].length;o++)if(this.maze.level[i][o]===n)return{col:o,row:i};return{col:9,row:12}}detectCollissionWithBiscuit(){const n=this.segments[0];let i=this.getPositionInMaze(this.direction,n.x,n.y);this.maze.getElement(i.col,i.row)===f.BISCUIT&&(this.game.sound.playSound(m.BISCUIT),this.game.score++,this.maze.setElement(i.col,i.row,f.EMPTY),this.grow())}detectCollissionWithPill(){const n=this.segments[0];let i=this.getPositionInMaze(this.direction,n.x,n.y);this.maze.getElement(i.col,i.row)===f.PILL&&(this.game.sound.playSound(m.PILL),this.game.score=this.game.score+10,this.maze.setElement(i.col,i.row,f.EMPTY),this.shrink(),this.createParticles(),this.game.enemy.blinking=!0,this.game.enemy2.blinking=!0,this.maze.step=0)}getPositionInMaze(n,i,o){let d=9,N=12;return 0!==this.segments.length?((n===l.Right||n===l.Down)&&(d=Math.ceil(i/this.maze.cellSize),N=Math.ceil(o/this.maze.cellSize)),(n===l.Up||n===l.Left)&&(d=Math.floor(i/this.maze.cellSize),N=Math.floor(o/this.maze.cellSize)),{col:d,row:N}):{col:d,row:N}}getPositionOnScreen(n,i){return 0!==this.segments.length?{x:n*this.maze.cellSize,y:i*this.maze.cellSize}:{x:9,y:12}}move(){const n=this.segments[0];let i,o;switch(this.nextDirection){case l.Up:i=this.getPositionInMaze(this.nextDirection,n.x,n.y-this.speed),this.detectWallCollision(i.col,i.row)||(this.direction=l.Up);break;case l.Down:i=this.getPositionInMaze(this.nextDirection,n.x,n.y+this.speed),this.detectWallCollision(i.col,i.row)||(this.direction=l.Down);break;case l.Left:i=this.getPositionInMaze(this.nextDirection,n.x-this.speed,n.y),this.detectWallCollision(i.col,i.row)||(this.direction=l.Left);break;case l.Right:i=this.getPositionInMaze(this.nextDirection,n.x+this.speed,n.y),this.detectWallCollision(i.col,i.row)||(this.direction=l.Right)}switch(this.direction){case l.Up:i=this.getPositionInMaze(this.direction,n.x,n.y-this.speed),this.detectWallCollision(i.col,i.row)||(o=this.getPositionOnScreen(i.col,i.row),this.segments.unshift({x:o.x,y:n.y-this.speed}),this.segments.pop());break;case l.Down:i=this.getPositionInMaze(this.direction,n.x,n.y+this.speed),this.detectWallCollision(i.col,i.row)||(o=this.getPositionOnScreen(i.col,i.row),this.segments.unshift({x:o.x,y:n.y+this.speed}),this.segments.pop());break;case l.Left:i=this.getPositionInMaze(this.direction,n.x-this.speed,n.y),this.detectWallCollision(i.col,i.row)||(o=this.getPositionOnScreen(i.col,i.row),this.segments.unshift({x:n.x-this.speed,y:o.y}),this.segments.pop());break;case l.Right:i=this.getPositionInMaze(this.direction,n.x+this.speed,n.y),this.detectWallCollision(i.col,i.row)||(o=this.getPositionOnScreen(i.col,i.row),this.segments.unshift({x:n.x+this.speed,y:o.y}),this.segments.pop())}}detectWallCollision(n,i){return this.maze.getElement(n,i)===f.WALL}grow(){this.segments.push(this.segments[this.segments.length-1])}shrink(){this.segments=this.segments.slice(0,3)}die(){this.dead=!0,this.game.lives--,this.reset()}reset(){this.dead=!1,this.segments=[],this.segments.push({x:9*this.maze.cellSize,y:16*this.maze.cellSize}),this.game.sound.playSound(m.INTRO)}}var S=w(5386);class dt{constructor(n,i){this.speed=10,this.score=0,this.dead=!0,this.context=n,this.maze=i.maze,this.snake=i.snake,this.game=i,this.direction=l.Right,this.position=this.getPositionOnScreen(0,10),this.reset()}draw(){this.dead||(this.context.font="30px Arial",this.context.fillText(this.game.levels[this.game.level-1%this.game.levels.length],this.position.x,this.position.y+30))}update(){this.dead||(this.move(),this.detectCollissionWithSnake(),this.detectCollissionWithDoor())}detectCollissionWithSnake(){const n=this.position;for(let i=0;i<this.snake.segments.length;i++){const o=this.snake.segments[i];o.x===n.x&&o.y===n.y&&this.die()}}detectCollissionWithDoor(){const n=this.position;let i=this.getPositionInMaze(n.x,n.y);if(this.maze.getElement(i.col,i.row)===f.LEFT_DOOR){let o=this.findGameElementPosition(f.RIGHT_DOOR);this.position.x=this.getPositionOnScreen(o.col-1,o.row).x}if(this.maze.getElement(i.col,i.row)===f.RIGHT_DOOR){let o=this.findGameElementPosition(f.LEFT_DOOR);this.position.x=this.getPositionOnScreen(o.col+1,o.row).x}}findGameElementPosition(n){for(let i=0;i<this.maze.level.length;i++)for(let o=0;o<this.maze.level[i].length;o++)if(this.maze.level[i][o]===n)return{col:o,row:i};return{col:9,row:12}}getPositionInMaze(n,i){let o=9,d=12;return(this.direction===l.Right||this.direction===l.Down)&&(o=Math.ceil(n/this.maze.cellSize),d=Math.ceil(i/this.maze.cellSize)),(this.direction===l.Up||this.direction===l.Left)&&(o=Math.floor(n/this.maze.cellSize),d=Math.floor(i/this.maze.cellSize)),{col:o,row:d}}getPositionOnScreen(n,i){return{x:n*this.maze.cellSize,y:i*this.maze.cellSize}}move(){const n=this.position;let i,o;switch(this.direction){case l.Up:i=this.getPositionInMaze(n.x,n.y-this.speed),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:o.x,y:n.y-this.speed});break;case l.Down:i=this.getPositionInMaze(n.x,n.y+this.speed),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:o.x,y:n.y+this.speed});break;case l.Left:i=this.getPositionInMaze(n.x-this.speed,n.y),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:n.x-this.speed,y:o.y});break;case l.Right:i=this.getPositionInMaze(n.x+this.speed,n.y),this.detectWallCollision(i.col,i.row)?this.setRandomDirection():(o=this.getPositionOnScreen(i.col,i.row),this.position={x:n.x+this.speed,y:o.y})}this.maze.step%20==0&&this.setRandomDirection(),this.maze.step%30==0&&this.updateDirection()}updateDirection(){let n=this.snake.segments[0];if(!n)return;const i=n.x-this.position.x,o=n.y-this.position.y;Math.sqrt(i*i+o*o),this.direction=i<0&&Math.abs(i)>Math.abs(o)?l.Right:i>0&&Math.abs(i)>Math.abs(o)?l.Left:o<0?l.Down:l.Up}setRandomDirection(){switch(Math.floor(4*Math.random())){case 0:this.direction=l.Up;break;case 1:this.direction=l.Down;break;case 2:this.direction=l.Left;break;case 3:this.direction=l.Right}}detectWallCollision(n,i){switch(this.direction){case l.Up:case l.Down:case l.Left:case l.Right:if(this.maze.getElement(n,i)===f.WALL)return!0}return!1}die(){this.game.sound.playSound(m.FRUIT),this.game.score=this.game.score+50*this.game.level,this.dead=!0}reset(){this.dead=!1,this.position=this.getPositionOnScreen(0,10)}}var pt=w(2598),a=w(8256),it=w(452);const st=["canvas"];function mt(c,n){1&c&&(a.TgZ(0,"span"),a._uU(1,"\u{1f40d}"),a.qZA())}function V(c,n){1&c&&(a.TgZ(0,"div",19),a._uU(1,"Game Over"),a.qZA())}function J(c,n){1&c&&(a.TgZ(0,"div",20),a._uU(1,"You Win!"),a.qZA())}function vt(c,n){1&c&&(a.TgZ(0,"div",20),a._uU(1,"Get Ready!"),a.qZA())}function L(c,n){1&c&&(a.TgZ(0,"div",20),a._uU(1,"Bonus!"),a.qZA())}function Q(c,n){1&c&&(a.TgZ(0,"div",21),a._uU(1,"PAUSED"),a.qZA())}const H=function(){return[]};let $=(()=>{class c{constructor(i,o){this.router=i,this.settingsService=o,this.title="SnakeMan",this.score=0,this.highScore=parseInt(localStorage.getItem("snakeman-highscore")||"0"),this.paused=!1,this.gameOver=!1,this.winner=!1,this.lives=3,this.levels=["\u{1f352}","\u{1f353}","\u{1f34a}","\u{1f34e}","\u{1f347}","\u{1f351}","\u{1f349}","\u{1f34c}","\u{1f968}","\u{1f511}"],this.level=1,this.debugString="",this.showSettings=!1,this.router.events.subscribe(d=>{d instanceof pt.OD&&"/game"!==d.url&&(clearInterval(this.timer),this.timer=null,this.paused=!0)}),this.sound=new G(this.settingsService)}ngAfterViewInit(){var i;this.context=null===(i=this.canvas)||void 0===i?void 0:i.nativeElement.getContext("2d"),this.context&&(this.startGame(),this.setupKeyboardEvents())}startGame(){this.paused?this.pauseGame():this.context&&(this.maze=new ft(this.context,this),this.snake=new gt(this.context,this),this.enemy=new C(this.context,this),this.enemy2=new C(this.context,this),this.fruit=new dt(this.context,this),this.hideText(),this.timer&&clearInterval(this.timer),this.timer=setInterval(()=>{this.update(),this.draw()},60))}hideText(){this.paused=!1,this.gameOver=!1,this.winner=!1}startStopTimer(){this.timer?(clearInterval(this.timer),this.timer=null):this.timer=setInterval(()=>{this.draw(),this.update()},60)}pauseGame(){this.startStopTimer(),this.paused=!this.paused}draw(){this.maze.draw(),this.snake.draw(),this.enemy.draw(),this.enemy2.draw(),this.fruit.draw()}update(){this.sound.playingIntro||(this.snake.update(),this.maze.update(),this.enemy.update(),this.enemy2.update(),this.fruit.update(),this.lives<1&&(this.gameOver=!0,this.recordHighScore(),this.startStopTimer()),this.maze.winner&&(this.level++,this.startGame()))}recordHighScore(){this.score>this.highScore&&(this.highScore=this.score,localStorage.setItem("snakeman-highscore",this.score.toString()))}setupKeyboardEvents(){document.addEventListener("keydown",o=>{switch(o.key){case"ArrowUp":case"w":(!this.enemy.blinking&&this.snake.direction!==l.Down||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Up),this.enemy.blinking&&(this.snake.nextDirection=l.Up);break;case"ArrowDown":case"s":(!this.enemy.blinking&&this.snake.direction!==l.Up||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Down),this.enemy.blinking&&(this.snake.nextDirection=l.Down);break;case"ArrowLeft":case"a":(!this.enemy.blinking&&this.snake.direction!==l.Right||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Left),this.enemy.blinking&&(this.snake.nextDirection=l.Left);break;case"ArrowRight":case"d":(!this.enemy.blinking&&this.snake.direction!==l.Left||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Right),this.enemy.blinking&&(this.snake.nextDirection=l.Right);break;case"p":this.pauseGame()}});let i=document.getElementById("pad");this.hammer=new S.Manager(i),this.hammer.add(new S.Swipe({direction:S.DIRECTION_ALL,threshold:3,velocity:.2})),this.hammer.on("swipeleft",()=>{(!this.enemy.blinking&&this.snake.direction!==l.Right||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Left),this.enemy.blinking&&(this.snake.nextDirection=l.Left)}),this.hammer.on("swiperight",()=>{(!this.enemy.blinking&&this.snake.direction!==l.Left||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Right),this.enemy.blinking&&(this.snake.nextDirection=l.Right)}),this.hammer.on("swipeup",()=>{(!this.enemy.blinking&&this.snake.direction!==l.Down||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Up),this.enemy.blinking&&(this.snake.nextDirection=l.Up)}),this.hammer.on("swipedown",()=>{(!this.enemy.blinking&&this.snake.direction!==l.Up||1===this.snake.segments.length)&&(this.snake.nextDirection=l.Down),this.enemy.blinking&&(this.snake.nextDirection=l.Down)})}settings(){this.showSettings=!this.showSettings}}return c.\u0275fac=function(i){return new(i||c)(a.Y36(pt.F0),a.Y36(it.g))},c.\u0275cmp=a.Xpm({type:c,selectors:[["app-game"]],viewQuery:function(i,o){if(1&i&&a.Gf(st,7),2&i){let d;a.iGM(d=a.CRH())&&(o.canvas=d.first)}},standalone:!0,features:[a.jDz],decls:40,vars:13,consts:[[3,"translucent"],["slot","start"],[1,"title"],["id","pad","scrollY","false",3,"fullscreen"],[1,"score"],[1,"left"],["size","auto",1,"left"],[1,"right"],[3,"click"],["name","play-outline"],["name","pause-outline"],["size","auto"],["width","570","height","630"],["canvas",""],[4,"ngFor","ngForOf"],["size","auto",1,"center"],["class","red-text",4,"ngIf"],["class","green-text",4,"ngIf"],["class","white-text",4,"ngIf"],[1,"red-text"],[1,"green-text"],[1,"white-text"]],template:function(i,o){1&i&&(a.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),a._UZ(3,"ion-menu-button"),a.qZA(),a.TgZ(4,"ion-title",2),a._uU(5,"SnakeMan"),a.qZA()()(),a.TgZ(6,"ion-content",3)(7,"ion-grid")(8,"ion-row",4)(9,"ion-col",5),a._uU(10,"SCORE"),a._UZ(11,"br"),a._uU(12),a.qZA(),a.TgZ(13,"ion-col",6),a._uU(14,"HIGH SCORE"),a._UZ(15,"br"),a._uU(16),a.qZA(),a.TgZ(17,"ion-col",7)(18,"button",8),a.NdJ("click",function(){return o.score=0,o.level=1,o.lives=3,o.startGame()}),a._UZ(19,"ion-icon",9),a.qZA(),a.TgZ(20,"button",8),a.NdJ("click",function(){return o.pauseGame()}),a._UZ(21,"ion-icon",10),a.qZA()()(),a.TgZ(22,"ion-row",11)(23,"ion-col"),a._UZ(24,"canvas",12,13),a.qZA()(),a.TgZ(26,"ion-row")(27,"ion-col",5),a.YNc(28,mt,2,0,"span",14),a.qZA(),a.TgZ(29,"ion-col",15),a.YNc(30,V,2,0,"div",16),a.YNc(31,J,2,0,"div",17),a.YNc(32,vt,2,0,"div",17),a.YNc(33,L,2,0,"div",17),a.YNc(34,Q,2,0,"div",18),a.qZA(),a.TgZ(35,"ion-col",7)(36,"span"),a._uU(37),a.qZA(),a.TgZ(38,"span"),a._uU(39),a.qZA()()()()()),2&i&&(a.Q6J("translucent",!0),a.xp6(6),a.Q6J("fullscreen",!0),a.xp6(6),a.Oqu(o.score),a.xp6(4),a.Oqu(o.highScore),a.xp6(12),a.Q6J("ngForOf",a.DdM(12,H).constructor(o.lives)),a.xp6(2),a.Q6J("ngIf",o.gameOver),a.xp6(1),a.Q6J("ngIf",o.winner),a.xp6(1),a.Q6J("ngIf",o.sound.playingIntro&&!o.gameOver),a.xp6(1),a.Q6J("ngIf",o.sound.playingPowerup),a.xp6(1),a.Q6J("ngIf",o.paused),a.xp6(3),a.Oqu(o.levels[o.level-1%o.levels.length]),a.xp6(2),a.Oqu(o.level))},dependencies:[x.Pc,x.Sm,x.wI,x.W2,x.jY,x.Gu,x.gu,x.fG,x.Nd,x.wd,x.sr,Y.ez,Y.sg,Y.O5,y.u5],styles:["ion-grid[_ngcontent-%COMP%]{overflow-y:hidden;max-width:380px}canvas[_ngcontent-%COMP%]{width:100%;height:auto;max-width:570px;max-height:660px}.left[_ngcontent-%COMP%]{text-align:left}.center[_ngcontent-%COMP%]{text-align:center}.right[_ngcontent-%COMP%]{text-align:right}.title[_ngcontent-%COMP%]{font-size:28px;text-shadow:0 0 2px #00ff00,0 0 5px #00ff00,0 0 7px #00ff00,0 0 10px #00ff00,0 0 12px #00ff00}.white-text[_ngcontent-%COMP%]{color:#fff}.red-text[_ngcontent-%COMP%]{color:red}.green-text[_ngcontent-%COMP%]{color:green}button[_ngcontent-%COMP%]{font-size:26px;background-color:#000;color:#fff;border:1px solid white;border-radius:5px;padding:2px;margin-left:10px;width:44px;cursor:pointer}.score[_ngcontent-%COMP%]{font-size:18px;padding-top:5px;color:#fff}.lives[_ngcontent-%COMP%], .bonus[_ngcontent-%COMP%]{font-size:20px;padding-top:5px}"]}),c})()},5386:(bt,K,w)=>{var Y;!function(y,x,l,f){"use strict";var S,ft=["","webkit","Moz","MS","ms","o"],m=x.createElement("div"),b="function",G=Math.round,C=Math.abs,tt=Date.now;function et(t,e,s){return setTimeout(it(t,s),e)}function A(t,e,s){return!!Array.isArray(t)&&(I(t,s[e],s),!0)}function I(t,e,s){var r;if(t)if(t.forEach)t.forEach(e,s);else if(t.length!==f)for(r=0;r<t.length;)e.call(s,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(s,t[r],r,t)}function gt(t,e,s){var r="DEPRECATED METHOD: "+e+"\n"+s+" AT \n";return function(){var h=new Error("get-stack-trace"),u=h&&h.stack?h.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",g=y.console&&(y.console.warn||y.console.log);return g&&g.call(y.console,r,u),t.apply(this,arguments)}}S="function"!=typeof Object.assign?function(e){if(e===f||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),r=1;r<arguments.length;r++){var h=arguments[r];if(h!==f&&null!==h)for(var u in h)h.hasOwnProperty(u)&&(s[u]=h[u])}return s}:Object.assign;var dt=gt(function(e,s,r){for(var h=Object.keys(s),u=0;u<h.length;)(!r||r&&e[h[u]]===f)&&(e[h[u]]=s[h[u]]),u++;return e},"extend","Use `assign`."),pt=gt(function(e,s){return dt(e,s,!0)},"merge","Use `assign`.");function a(t,e,s){var h,r=e.prototype;(h=t.prototype=Object.create(r)).constructor=t,h._super=r,s&&S(h,s)}function it(t,e){return function(){return t.apply(e,arguments)}}function st(t,e){return typeof t==b?t.apply(e&&e[0]||f,e):t}function mt(t,e){return t===f?e:t}function V(t,e,s){I(Q(e),function(r){t.addEventListener(r,s,!1)})}function J(t,e,s){I(Q(e),function(r){t.removeEventListener(r,s,!1)})}function vt(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function L(t,e){return t.indexOf(e)>-1}function Q(t){return t.trim().split(/\s+/g)}function H(t,e,s){if(t.indexOf&&!s)return t.indexOf(e);for(var r=0;r<t.length;){if(s&&t[r][s]==e||!s&&t[r]===e)return r;r++}return-1}function $(t){return Array.prototype.slice.call(t,0)}function c(t,e,s){for(var r=[],h=[],u=0;u<t.length;){var g=e?t[u][e]:t[u];H(h,g)<0&&r.push(t[u]),h[u]=g,u++}return s&&(r=e?r.sort(function(T,E){return T[e]>E[e]}):r.sort()),r}function n(t,e){for(var s,r,h=e[0].toUpperCase()+e.slice(1),u=0;u<ft.length;){if((r=(s=ft[u])?s+h:e)in t)return r;u++}return f}var i=1;function d(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||y}var Tt="ontouchstart"in y,oe=n(y,"PointerEvent")!==f,ae=Tt&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),nt="touch",Dt="mouse",ce=25,P=1,Z=2,p=4,O=8,yt=1,rt=2,ot=4,at=8,ht=16,R=rt|ot,X=at|ht,Ht=R|X,Ft=["x","y"],Pt=["clientX","clientY"];function k(t,e){var s=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(r){st(t.options.enable,[t])&&s.handler(r)},this.init()}function fe(t,e,s){var r=s.pointers.length,h=s.changedPointers.length,u=e&P&&r-h==0,g=e&(p|O)&&r-h==0;s.isFirst=!!u,s.isFinal=!!g,u&&(t.session={}),s.eventType=e,function ge(t,e){var s=t.session,r=e.pointers,h=r.length;s.firstInput||(s.firstInput=Yt(e)),h>1&&!s.firstMultiple?s.firstMultiple=Yt(e):1===h&&(s.firstMultiple=!1);var u=s.firstInput,g=s.firstMultiple,v=g?g.center:u.center,T=e.center=Zt(r);e.timeStamp=tt(),e.deltaTime=e.timeStamp-u.timeStamp,e.angle=Ct(v,T),e.distance=Et(v,T),function de(t,e){var s=e.center,r=t.offsetDelta||{},h=t.prevDelta||{},u=t.prevInput||{};(e.eventType===P||u.eventType===p)&&(h=t.prevDelta={x:u.deltaX||0,y:u.deltaY||0},r=t.offsetDelta={x:s.x,y:s.y}),e.deltaX=h.x+(s.x-r.x),e.deltaY=h.y+(s.y-r.y)}(s,e),e.offsetDirection=qt(e.deltaX,e.deltaY);var E=Xt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=E.x,e.overallVelocityY=E.y,e.overallVelocity=C(E.x)>C(E.y)?E.x:E.y,e.scale=g?function ve(t,e){return Et(e[0],e[1],Pt)/Et(t[0],t[1],Pt)}(g.pointers,r):1,e.rotation=g?function me(t,e){return Ct(e[1],e[0],Pt)+Ct(t[1],t[0],Pt)}(g.pointers,r):0,e.maxPointers=s.prevInput?e.pointers.length>s.prevInput.maxPointers?e.pointers.length:s.prevInput.maxPointers:e.pointers.length,function pe(t,e){var h,u,g,v,s=t.lastInterval||e,r=e.timeStamp-s.timeStamp;if(e.eventType!=O&&(r>ce||s.velocity===f)){var T=e.deltaX-s.deltaX,E=e.deltaY-s.deltaY,M=Xt(r,T,E);u=M.x,g=M.y,h=C(M.x)>C(M.y)?M.x:M.y,v=qt(T,E),t.lastInterval=e}else h=s.velocity,u=s.velocityX,g=s.velocityY,v=s.direction;e.velocity=h,e.velocityX=u,e.velocityY=g,e.direction=v}(s,e);var M=t.element;vt(e.srcEvent.target,M)&&(M=e.srcEvent.target),e.target=M}(t,s),t.emit("hammer.input",s),t.recognize(s),t.session.prevInput=s}function Yt(t){for(var e=[],s=0;s<t.pointers.length;)e[s]={clientX:G(t.pointers[s].clientX),clientY:G(t.pointers[s].clientY)},s++;return{timeStamp:tt(),pointers:e,center:Zt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Zt(t){var e=t.length;if(1===e)return{x:G(t[0].clientX),y:G(t[0].clientY)};for(var s=0,r=0,h=0;h<e;)s+=t[h].clientX,r+=t[h].clientY,h++;return{x:G(s/e),y:G(r/e)}}function Xt(t,e,s){return{x:e/t||0,y:s/t||0}}function qt(t,e){return t===e?yt:C(t)>=C(e)?t<0?rt:ot:e<0?at:ht}function Et(t,e,s){s||(s=Ft);var r=e[s[0]]-t[s[0]],h=e[s[1]]-t[s[1]];return Math.sqrt(r*r+h*h)}function Ct(t,e,s){return s||(s=Ft),180*Math.atan2(e[s[1]]-t[s[1]],e[s[0]]-t[s[0]])/Math.PI}k.prototype={handler:function(){},init:function(){this.evEl&&V(this.element,this.evEl,this.domHandler),this.evTarget&&V(this.target,this.evTarget,this.domHandler),this.evWin&&V(d(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&J(this.element,this.evEl,this.domHandler),this.evTarget&&J(this.target,this.evTarget,this.domHandler),this.evWin&&J(d(this.element),this.evWin,this.domHandler)}};var Te={mousedown:P,mousemove:Z,mouseup:p},ye="mousedown",Pe="mousemove mouseup";function xt(){this.evEl=ye,this.evWin=Pe,this.pressed=!1,k.apply(this,arguments)}a(xt,k,{handler:function(e){var s=Te[e.type];s&P&&0===e.button&&(this.pressed=!0),s&Z&&1!==e.which&&(s=p),this.pressed&&(s&p&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[e],changedPointers:[e],pointerType:Dt,srcEvent:e}))}});var Ee={pointerdown:P,pointermove:Z,pointerup:p,pointercancel:O,pointerout:O},xe={2:nt,3:"pen",4:Dt,5:"kinect"},Bt="pointerdown",Vt="pointermove pointerup pointercancel";function Rt(){this.evEl=Bt,this.evWin=Vt,k.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}y.MSPointerEvent&&!y.PointerEvent&&(Bt="MSPointerDown",Vt="MSPointerMove MSPointerUp MSPointerCancel"),a(Rt,k,{handler:function(e){var s=this.store,r=!1,h=e.type.toLowerCase().replace("ms",""),u=Ee[h],g=xe[e.pointerType]||e.pointerType,v=g==nt,T=H(s,e.pointerId,"pointerId");u&P&&(0===e.button||v)?T<0&&(s.push(e),T=s.length-1):u&(p|O)&&(r=!0),!(T<0)&&(s[T]=e,this.callback(this.manager,u,{pointers:s,changedPointers:[e],pointerType:g,srcEvent:e}),r&&s.splice(T,1))}});var Ie={touchstart:P,touchmove:Z,touchend:p,touchcancel:O},Se="touchstart",Oe="touchstart touchmove touchend touchcancel";function Jt(){this.evTarget=Se,this.evWin=Oe,this.started=!1,k.apply(this,arguments)}function ke(t,e){var s=$(t.touches),r=$(t.changedTouches);return e&(p|O)&&(s=c(s.concat(r),"identifier",!0)),[s,r]}a(Jt,k,{handler:function(e){var s=Ie[e.type];if(s===P&&(this.started=!0),this.started){var r=ke.call(this,e,s);s&(p|O)&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,s,{pointers:r[0],changedPointers:r[1],pointerType:nt,srcEvent:e})}}});var _e={touchstart:P,touchmove:Z,touchend:p,touchcancel:O},we="touchstart touchmove touchend touchcancel";function It(){this.evTarget=we,this.targetIds={},k.apply(this,arguments)}function be(t,e){var s=$(t.touches),r=this.targetIds;if(e&(P|Z)&&1===s.length)return r[s[0].identifier]=!0,[s,s];var h,u,g=$(t.changedTouches),v=[],T=this.target;if(u=s.filter(function(E){return vt(E.target,T)}),e===P)for(h=0;h<u.length;)r[u[h].identifier]=!0,h++;for(h=0;h<g.length;)r[g[h].identifier]&&v.push(g[h]),e&(p|O)&&delete r[g[h].identifier],h++;return v.length?[c(u.concat(v),"identifier",!0),v]:void 0}a(It,k,{handler:function(e){var s=_e[e.type],r=be.call(this,e,s);r&&this.callback(this.manager,s,{pointers:r[0],changedPointers:r[1],pointerType:nt,srcEvent:e})}});var De=2500,Qt=25;function zt(){k.apply(this,arguments);var t=it(this.handler,this);this.touch=new It(this.manager,t),this.mouse=new xt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Ce(t,e){t&P?(this.primaryTouch=e.changedPointers[0].identifier,$t.call(this,e)):t&(p|O)&&$t.call(this,e)}function $t(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var s={x:e.clientX,y:e.clientY};this.lastTouches.push(s);var r=this.lastTouches;setTimeout(function(){var u=r.indexOf(s);u>-1&&r.splice(u,1)},De)}}function Re(t){for(var e=t.srcEvent.clientX,s=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var h=this.lastTouches[r],u=Math.abs(e-h.x),g=Math.abs(s-h.y);if(u<=Qt&&g<=Qt)return!0}return!1}a(zt,k,{handler:function(e,s,r){var u=r.pointerType==Dt;if(!(u&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(r.pointerType==nt)Ce.call(this,s,r);else if(u&&Re.call(this,r))return;this.callback(e,s,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var jt=n(m.style,"touchAction"),Kt=jt!==f,te="compute",Mt="manipulation",q="none",lt="pan-x",ct="pan-y",St=function Me(){if(!Kt)return!1;var t={},e=y.CSS&&y.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(s){t[s]=!e||y.CSS.supports("touch-action",s)}),t}();function At(t,e){this.manager=t,this.set(e)}At.prototype={set:function(t){t==te&&(t=this.compute()),Kt&&this.manager.element.style&&St[t]&&(this.manager.element.style[jt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return I(this.manager.recognizers,function(e){st(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function ze(t){if(L(t,q))return q;var e=L(t,lt),s=L(t,ct);return e&&s?q:e||s?e?lt:ct:L(t,Mt)?Mt:"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,s=t.offsetDirection;if(!this.manager.session.prevented){var r=this.actions,h=L(r,q)&&!St[q],u=L(r,ct)&&!St[ct],g=L(r,lt)&&!St[lt];if(h&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;return g&&u||!(h||u&&s&R||g&&s&X)?void 0:this.preventSrc(e)}e.preventDefault()},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ot=1,_=2,j=4,F=8,U=F,ut=16,z=32;function W(t){this.options=S({},this.defaults,t||{}),this.id=function o(){return i++}(),this.manager=null,this.options.enable=mt(this.options.enable,!0),this.state=Ot,this.simultaneous={},this.requireFail=[]}function ie(t){return t&ut?"cancel":t&F?"end":t&j?"move":t&_?"start":""}function se(t){return t==ht?"down":t==at?"up":t==rt?"left":t==ot?"right":""}function kt(t,e){var s=e.manager;return s?s.get(t):t}function D(){W.apply(this,arguments)}function _t(){D.apply(this,arguments),this.pX=null,this.pY=null}function Lt(){D.apply(this,arguments)}function Nt(){W.apply(this,arguments),this._timer=null,this._input=null}function Ut(){D.apply(this,arguments)}function Wt(){D.apply(this,arguments)}function wt(){W.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function B(t,e){return(e=e||{}).recognizers=mt(e.recognizers,B.defaults.preset),new Gt(t,e)}function Gt(t,e){this.options=S({},B.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function ue(t){return new(t.options.inputClass||(oe?Rt:ae?It:Tt?zt:xt))(t,fe)}(this),this.touchAction=new At(this,this.options.touchAction),re(this,!0),I(this.options.recognizers,function(s){var r=this.add(new s[0](s[1]));s[2]&&r.recognizeWith(s[2]),s[3]&&r.requireFailure(s[3])},this)}function re(t,e){var r,s=t.element;s.style&&(I(t.options.cssProps,function(h,u){r=n(s.style,u),e?(t.oldCssProps[r]=s.style[r],s.style[r]=h):s.style[r]=t.oldCssProps[r]||""}),e||(t.oldCssProps={}))}W.prototype={defaults:{},set:function(t){return S(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(A(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=kt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return A(t,"dropRecognizeWith",this)||(t=kt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(A(t,"requireFailure",this))return this;var e=this.requireFail;return-1===H(e,t=kt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(A(t,"dropRequireFailure",this))return this;t=kt(t,this);var e=H(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,s=this.state;function r(h){e.manager.emit(h,t)}s<F&&r(e.options.event+ie(s)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),s>=F&&r(e.options.event+ie(s))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=z},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(z|Ot)))return!1;t++}return!0},recognize:function(t){var e=S({},t);if(!st(this.options.enable,[this,e]))return this.reset(),void(this.state=z);this.state&(U|ut|z)&&(this.state=Ot),this.state=this.process(e),this.state&(_|j|F|ut)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},a(D,W,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,s=t.eventType,r=e&(_|j),h=this.attrTest(t);return r&&(s&O||!h)?e|ut:r||h?s&p?e|F:e&_?e|j:_:z}}),a(_t,D,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ht},getTouchAction:function(){var t=this.options.direction,e=[];return t&R&&e.push(ct),t&X&&e.push(lt),e},directionTest:function(t){var e=this.options,s=!0,r=t.distance,h=t.direction,u=t.deltaX,g=t.deltaY;return h&e.direction||(e.direction&R?(h=0===u?yt:u<0?rt:ot,s=u!=this.pX,r=Math.abs(t.deltaX)):(h=0===g?yt:g<0?at:ht,s=g!=this.pY,r=Math.abs(t.deltaY))),t.direction=h,s&&r>e.threshold&&h&e.direction},attrTest:function(t){return D.prototype.attrTest.call(this,t)&&(this.state&_||!(this.state&_)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=se(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),a(Lt,D,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[q]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&_)},emit:function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),this._super.emit.call(this,t)}}),a(Nt,W,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,s=t.pointers.length===e.pointers,r=t.distance<e.threshold,h=t.deltaTime>e.time;if(this._input=t,!r||!s||t.eventType&(p|O)&&!h)this.reset();else if(t.eventType&P)this.reset(),this._timer=et(function(){this.state=U,this.tryEmit()},e.time,this);else if(t.eventType&p)return U;return z},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===U&&(t&&t.eventType&p?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=tt(),this.manager.emit(this.options.event,this._input)))}}),a(Ut,D,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[q]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&_)}}),a(Wt,D,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:R|X,pointers:1},getTouchAction:function(){return _t.prototype.getTouchAction.call(this)},attrTest:function(t){var s,e=this.options.direction;return e&(R|X)?s=t.overallVelocity:e&R?s=t.overallVelocityX:e&X&&(s=t.overallVelocityY),this._super.attrTest.call(this,t)&&e&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&C(s)>this.options.velocity&&t.eventType&p},emit:function(t){var e=se(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),a(wt,W,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,s=t.pointers.length===e.pointers,r=t.distance<e.threshold,h=t.deltaTime<e.time;if(this.reset(),t.eventType&P&&0===this.count)return this.failTimeout();if(r&&h&&s){if(t.eventType!=p)return this.failTimeout();var u=!this.pTime||t.timeStamp-this.pTime<e.interval,g=!this.pCenter||Et(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,g&&u?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=et(function(){this.state=U,this.tryEmit()},e.interval,this),_):U}return z},failTimeout:function(){return this._timer=et(function(){this.state=z},this.options.interval,this),z},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==U&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),B.VERSION="2.0.7",B.defaults={domEvents:!1,touchAction:te,enable:!0,inputTarget:null,inputClass:null,preset:[[Ut,{enable:!1}],[Lt,{enable:!1},["rotate"]],[Wt,{direction:R}],[_t,{direction:R},["swipe"]],[wt],[wt,{event:"doubletap",taps:2},["tap"]],[Nt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Gt.prototype={set:function(t){return S(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var s,r=this.recognizers,h=e.curRecognizer;(!h||h&&h.state&U)&&(h=e.curRecognizer=null);for(var u=0;u<r.length;)s=r[u],2===e.stopped||h&&s!=h&&!s.canRecognizeWith(h)?s.reset():s.recognize(t),!h&&s.state&(_|j|F)&&(h=e.curRecognizer=s),u++}},get:function(t){if(t instanceof W)return t;for(var e=this.recognizers,s=0;s<e.length;s++)if(e[s].options.event==t)return e[s];return null},add:function(t){if(A(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(A(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,s=H(e,t);-1!==s&&(e.splice(s,1),this.touchAction.update())}return this},on:function(t,e){if(t!==f&&e!==f){var s=this.handlers;return I(Q(t),function(r){s[r]=s[r]||[],s[r].push(e)}),this}},off:function(t,e){if(t!==f){var s=this.handlers;return I(Q(t),function(r){e?s[r]&&s[r].splice(H(s[r],e),1):delete s[r]}),this}},emit:function(t,e){this.options.domEvents&&function Le(t,e){var s=x.createEvent("Event");s.initEvent(t,!0,!0),s.gesture=e,e.target.dispatchEvent(s)}(t,e);var s=this.handlers[t]&&this.handlers[t].slice();if(s&&s.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<s.length;)s[r](e),r++}},destroy:function(){this.element&&re(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},S(B,{INPUT_START:P,INPUT_MOVE:Z,INPUT_END:p,INPUT_CANCEL:O,STATE_POSSIBLE:Ot,STATE_BEGAN:_,STATE_CHANGED:j,STATE_ENDED:F,STATE_RECOGNIZED:U,STATE_CANCELLED:ut,STATE_FAILED:z,DIRECTION_NONE:yt,DIRECTION_LEFT:rt,DIRECTION_RIGHT:ot,DIRECTION_UP:at,DIRECTION_DOWN:ht,DIRECTION_HORIZONTAL:R,DIRECTION_VERTICAL:X,DIRECTION_ALL:Ht,Manager:Gt,Input:k,TouchAction:At,TouchInput:It,MouseInput:xt,PointerEventInput:Rt,TouchMouseInput:zt,SingleTouchInput:Jt,Recognizer:W,AttrRecognizer:D,Tap:wt,Pan:_t,Swipe:Wt,Pinch:Lt,Rotate:Ut,Press:Nt,on:V,off:J,each:I,merge:pt,extend:dt,assign:S,inherit:a,bindFn:it,prefixed:n}),(typeof y<"u"?y:typeof self<"u"?self:{}).Hammer=B,(Y=function(){return B}.call(K,w,K,bt))!==f&&(bt.exports=Y)}(window,document)}}]);